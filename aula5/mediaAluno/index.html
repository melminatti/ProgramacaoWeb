<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Formulario</title>
</head>
<header>
    <h1> Notas </h1>
</header>
<body>
    <button onclick="toggleMediaNotas()">Média das Notas</button>
    <button onclick="toggleMediaAlunos()">Média dos Alunos</button>

    <table border="1px" id="tabela">
        <thead>
            <tr bgcolor="gray"> 
                <th rowspan="2">Nome</th>
                <th colspan="3">Semestre 1 </th>
                <th colspan="3">Semestre 2 </th>
                <th colspan="3">Semestre 3 </th>
            </tr>
            <tr> 
                <th>Nota 1</th>
                <th>Nota 2 </th>
                <th>Nota 3 </th>
                <th>Nota 1</th>
                <th>Nota 2 </th>
                <th>Nota 3 </th>
                <th>Nota 1</th>
                <th>Nota 2 </th>
                <th>Nota 3 </th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>João</td>
                <td><input type="text" value="10"></td>
                <td><input type="text" value="8"></td>
                <td><input type="text" value="9"></td>
                <td><input type="text" value="6"></td>
                <td><input type="text" value="8.7"></td>
                <td><input type="text" value="10"></td>
                <td><input type="text" value="6"></td>
                <td><input type="text" value="7"></td>
                <td><input type="text" value="9"></td>
            </tr>
            <tr>
                <td>Maria</td>
                <td><input type="text"></td><td><input type="text"></td><td><input type="text"></td>
                <td><input type="text"></td><td><input type="text"></td><td><input type="text"></td>
                <td><input type="text"></td><td><input type="text"></td><td><input type="text"></td>
            </tr>
            <tr>
                <td>José</td>
                <td><input type="text"></td><td><input type="text"></td><td><input type="text"></td>
                <td><input type="text"></td><td><input type="text"></td><td><input type="text"></td>
                <td><input type="text"></td><td><input type="text"></td><td><input type="text"></td>
            </tr>
            <tr>
                <td>Paulo</td>
                <td><input type="text"></td><td><input type="text"></td><td><input type="text"></td>
                <td><input type="text"></td><td><input type="text"></td><td><input type="text"></td>
                <td><input type="text"></td><td><input type="text"></td><td><input type="text"></td>
            </tr>
            <tr>
                <td>Miguel</td>
                <td><input type="text"></td><td><input type="text"></td><td><input type="text"></td>
                <td><input type="text"></td><td><input type="text"></td><td><input type="text"></td>
                <td><input type="text"></td><td><input type="text"></td><td><input type="text"></td>
            </tr>
            <tr>
                <td>Julia</td>
                <td><input type="text"></td><td><input type="text"></td><td><input type="text"></td>
                <td><input type="text"></td><td><input type="text"></td><td><input type="text"></td>
                <td><input type="text"></td><td><input type="text"></td><td><input type="text"></td>
            </tr>
        </tbody>
    </table>

    <script>
        document.querySelectorAll("tbody input").forEach(input => {
            input.value = (Math.random() * 10).toFixed(1);
        });

        let mediaNotasAtiva = false;
        let mediaAlunosAtiva = false;

        function toggleMediaNotas() {
            const tabela = document.getElementById("tabela");
            const tbody = tabela.querySelector("tbody");

            if (mediaNotasAtiva) {
                tbody.deleteRow(tbody.rows.length - 1);
                mediaNotasAtiva = false;
                return;
            }

            const row = tbody.insertRow();
            row.insertCell().innerText = "Média Notas";

            for (let col = 1; col <= 9; col++) {
                let soma = 0;
                let count = 0;
                for (let r = 0; r < tbody.rows.length - 1; r++) {
                    const input = tbody.rows[r].cells[col].querySelector("input");
                    if (input) {
                        const val = parseFloat(input.value);
                        if (!isNaN(val)) {
                            soma += val;
                            count++;
                        }
                    }
                }
                const media = (soma / count).toFixed(1);
                row.insertCell().innerText = media;
            }

            if (mediaAlunosAtiva) {
                row.insertCell().innerText = "-";
            }

            mediaNotasAtiva = true;
        }

        function toggleMediaAlunos() {
            const tabela = document.getElementById("tabela");
            const tbody = tabela.querySelector("tbody");
            const header = tabela.querySelector("thead tr:last-child");

            if (mediaAlunosAtiva) {
                header.deleteCell(header.cells.length - 1);
                for (let r = 0; r < tbody.rows.length; r++) {
                    tbody.rows[r].deleteCell(tbody.rows[r].cells.length - 1);
                }
                mediaAlunosAtiva = false;
                return;
            }

            header.insertCell().innerText = "Média";

            for (let r = 0; r < tbody.rows.length; r++) {
                if (mediaNotasAtiva && r === tbody.rows.length - 1) {
                    tbody.rows[r].insertCell().innerText = "-";
                    continue;
                }

                let soma = 0;
                let count = 0;
                for (let c = 1; c <= 9; c++) {
                    const input = tbody.rows[r].cells[c].querySelector("input");
                    if (input) {
                        const val = parseFloat(input.value);
                        if (!isNaN(val)) {
                            soma += val;
                            count++;
                        }
                    }
                }
                const media = (count > 0 ? (soma / count).toFixed(1) : "-");
                tbody.rows[r].insertCell().innerText = media;
            }

            mediaAlunosAtiva = true;
        }
    </script>
</body>
</html>
